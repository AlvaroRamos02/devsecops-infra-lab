# Gu√≠a de Integraci√≥n DevSecOps para GitHub

Este esquema paso a paso detalla c√≥mo integrar el **DevSecOps Infra Lab** en una empresa que utiliza GitHub como plataforma de desarrollo.

## üìã Prerrequisitos
1.  **Docker Desktop** instalado en las m√°quinas de los desarrolladores.
2.  Una cuenta en **GitHub**.
3.  C√≥digo fuente de la aplicaci√≥n (ej. en Node.js, Python, Java).

---

## üöÄ Fase 1: Preparaci√≥n del Repositorio

El objetivo es configurar el repositorio para que incluya las herramientas de seguridad.

1.  **Estructura de Carpetas**:
    Organiza tu repositorio para separar el c√≥digo de la aplicaci√≥n de las herramientas de seguridad (dashboard).

    ```text
    mi-proyecto-empresa/
    ‚îú‚îÄ‚îÄ .github/workflows/    <-- Pipelines de CI/CD
    ‚îú‚îÄ‚îÄ app/                  <-- TU C√ìDIGO FUENTE AQU√ç (Reemplaza la carpeta app/ original)
    ‚îú‚îÄ‚îÄ dashboard/            <-- C√≥digo del Dashboard de Seguridad (No modificar)
    ‚îú‚îÄ‚îÄ scan.sh               <-- Script maestro de escaneo
    ‚îú‚îÄ‚îÄ docker-compose.yml    <-- Para levantar el dashboard localmente
    ‚îî‚îÄ‚îÄ Dockerfile            <-- Dockerfile de tu aplicaci√≥n (si aplica)
    ```

    > **Paso Clave**: Copia tu c√≥digo fuente dentro de la carpeta `app/` o modifica el script [scan.sh](file:///home/user/Escritorio/devsecops-infra-lab/scan.sh) para que apunte a tu directorio ra√≠z.

2.  **Prueba Local**:
    Antes de subir nada, verifica que los esc√°neres funcionan en tu m√°quina.
    ```bash
    chmod +x scan.sh
    ./scan.sh
    ```
    *Si todo va bien, ver√°s reportes en `dashboard/data/`.*

---

## üîÑ Fase 2: Configuraci√≥n de GitHub Actions (CI/CD)

Automatizaremos los escaneos para que se ejecuten con cada cambio en el c√≥digo (`push` o `Pull Request`).

1.  **Crear el Workflow**:
    Crea un archivo en `.github/workflows/devsecops.yml` con el siguiente contenido:

    ```yaml
    name: DevSecOps Vulnerability Scan
    
    on: [push, pull_request]

    jobs:
      security-check:
        runs-on: ubuntu-latest
        steps:
          # 1. Obtener el c√≥digo
          - name: Checkout Code
            uses: actions/checkout@v3

          # 2. Ejecutar Esc√°neres (SAST + SCA)
          - name: Run Security Scan
            run: |
              chmod +x scan.sh
              ./scan.sh

          # 3. Guardar Reportes como Artefactos
          - name: Upload Report Data
            uses: actions/upload-artifact@v3
            if: always() # Guardar incluso si el escaneo falla
            with:
              name: security-dashboard-data
              path: dashboard/data/
    ```

2.  **Subir Cambios**:
    Haz `git commit` y `git push` de estos cambios a tu repositorio.

---

## üìä Fase 3: Visualizaci√≥n de Resultados

Una vez que el pipeline de GitHub termine:

### Opci√≥n A: Ver Resultados Descargados (Local)
1.  Ve a la pesta√±a **Actions** en tu repositorio de GitHub.
2.  Entra en la ejecuci√≥n m√°s reciente.
3.  Descarga el artefacto `security-dashboard-data`.
4.  Descomprime los archivos `.json` en tu carpeta local `dashboard/data/`.
5.  Levanta el dashboard:
    ```bash
    docker-compose up -d dashboard
    ```
6.  Abre **http://localhost:7890**.

### Opci√≥n B: Despliegue Centralizado (Empresarial)
Para una empresa, lo ideal es tener el dashboard corriendo permanentemente en un servidor.

1.  Despliega la carpeta `dashboard/` en un servidor interno o contenedor en la nube.
2.  Modifica el paso 3 del pipeline (Fase 2) para que, en lugar de subir un artefacto, **env√≠e los JSONs al servidor del dashboard** (ej. via `scp` o una petici√≥n POST).

---

## ‚úÖ Resumen del Flujo de Trabajo

1.  **Desarrollador** hace cambios en `app/` y sube un Pull Request.
2.  **GitHub Actions** detecta el cambio y ejecuta `./scan.sh`.
3.  **Herramientas** (Semgrep, Trivy) analizan el c√≥digo y generan reportes JSON.
4.  **Pipeline** guarda los reportes.
5.  **Equipo de Seguridad/L√≠der** descarga los reportes o revisa el dashboard para aprobar el PR.
